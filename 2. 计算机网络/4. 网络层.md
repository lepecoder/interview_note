网络层协议负责提供主机间的逻辑通信；运输层协议负责提供进程间的逻辑通信。

传输层是端到端的协议，只需要在两端主机运行；
而网络层协议在通信过程中的每个主机和路由器都需要运行；

网络层的两个核心功能是转发和路由

### 路由器分组转发流程

1. 从数据报的首部提取目的主机的 IP 地址 D，得到目的网络地址 N。
2. 若 N 就是与此路由器直接相连的某个网络地址，则进行直接交付；
3. 若路由表中有目的地址为 D 的特定主机路由，则把数据报传送给表中所指明的下一跳路由器；
4. 若路由表中有到达网络 N 的路由，则把数据报传送给路由表中所指明的下一跳路由器；
5. 若路由表中有一个默认路由，则把数据报传送给路由表中所指明的默认路由器；
6. 报告转发分组出错。

### 转发forwarding

> 将分组从路由器的输入端口转移到合适的输出端口，为此，路由器需要维护一个转发表\<地址，输出端口>
>

路由表结构

| 目的网络IP地址 | 子网掩码 | 下一跳IP地址 | 接口 |
| -------------- | -------- | ------------ | ---- |
|                |          |              |      |

### 路由选择routing

> 路由选择涉及一个网络中的所有路由器，他们使用路由协议交互，决定分组从源地址到目的地址所采用的路径。
>

### 无连接服务

* 数据报网络
* 不事先为系列分组确定传输路径
* 每个分组独立确定传输路径
* 不同分组可能路径不同

### 连接服务

- 虚电路网络
- 首先为系列分组的传输确定从源到目的经过的路径(建立连接)
- 沿路径传输系列分组
- 传输结束后拆除连接