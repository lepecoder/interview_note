B 树是平衡二叉树的扩展，又叫平衡多路查找树，属于多叉树。

## B 树特性

1. 所有叶子节点都在同一层，并且不带任何信息，可以看做是查找失败的节点。
2. 最小度数：$t$，除根节点外，
   1. 每个节点至少有 $t-1$ 个关键字。
   2. 每个节点至多有 $2t-1$ 个关键字
3. 包含 $t$ 个关键字的节点有 $t+1$ 个孩子。
4. 一个节点中所有关键字升序排列，两个关键字 $k_1, k_2$ 之间的孩子节点的所有关键字在 $(k_1, k_2)$ 之间。

![image.png](assets/image-20210818192825-7a8iser.png)

这棵 B 树的最小度数 $t=2$ ，根节点至少包含一个关键字，其它节点至少有 $t-1=1$ 个关键字，至多有 $2t-1=3$ 个关键字。

## B 树的查找

B 树的查找操作和二叉排序树类似，只是从原来的比较节点的一个值变成了比较k个值，查找到叶子节点(nullptr节点)时说明查找失败，没有对应值。

## B 树插入

假设我们要建一个平衡5路查找树，那么每个节点的关键字数必须<=4，比如我们插入 3、8、31、11，此时这个节点已经满了，如果要再插入，比如把这个节点拆分。

![平衡二叉树_B树_B_树_B_树_理解其中一种你就都明白了_-_知乎.jpg](assets/平衡二叉树_B树_B_树_B_树_理解其中一种你就都明白了_-_知乎-20210818195341-rytfoc1.jpg)

插入 23，发现超过了最大允许的关键字数量，从中间拆分成2组，之后再插入 29

![image.png](assets/image-20210818195328-uyt3oxj.png)

插入50，再插入29的时候又需要拆分。

## B 树删除

在删除时涉及到节点合并，当关键字个数<=4时就可以合并，此时先从子节点取，子节点没有符合条件时就向父节点取，取中间值往父节点放。

![image.png](assets/image-20210818201323-plyxari.png)

我们可以将节点的大小限制在一个磁盘块内，因此我们可以通过一次IO操作读取到一个节点的多个关键字，减少了查找次数。